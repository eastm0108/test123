(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-21c179c0"],{1396:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"container"},[a("div",{staticClass:"header"},[a("div",{staticClass:"header__title"},[a("i",{staticClass:"el-icon-location-information"}),a("p",[e._v("分店清單（"+e._s(e.storeList.length)+"間分店）")])]),a("div",{staticClass:"header__btnArea"},[a("el-button",{staticClass:"header__btnArea__addBranchBtn",on:{click:e.opendAddBranchDialog}},[a("i",{staticClass:"el-icon-add-location"}),e._v(" 新增分店 ")])],1)]),a("ul",{staticClass:"branchList"},e._l(e.storeList,(function(t,r){return a("li",{key:t.id,staticClass:"branchList__item",class:{"branchList__item--front":r%3==0,"branchList__item--middle":r%3==1,"branchList__item--back":r%3==2},on:{click:function(a){return a.target!==a.currentTarget?null:e.opendBranchDetailDialog(t.id,r)}}},[a("div",{staticClass:"branchList__item__info",on:{click:function(a){return e.opendBranchDetailDialog(t.id,r)}}},[a("div",{staticClass:"branchList__item__info__branch"},[a("p",{staticClass:"branchList__item__info__branch__location"},[e._v(" "+e._s(t.area)+" ")]),a("p",{staticClass:"branchList__item__info__branch__branchName"},[e._v(" "+e._s(t.name)+" ")]),a("p",{staticClass:"branchList__item__info__branch__manager"},[e._v(" "+e._s("店長："+t.manager.name)+" ")])]),a("div",{staticClass:"branchList__item__info__performance"},[a("div",{staticClass:"branchList__item__info__performance__text"},[a("p",{staticClass:"branchList__item__info__performance__text__context"},[e._v(e._s("業績/業績目標："))]),e.filterTargetValue(t,"results","value")>=e.filterTargetValue(t,"kpi","value")?a("p",{staticClass:"branchList__item__info__performance__text--success"},[e._v("(達標)")]):a("p",{staticClass:"branchList__item__info__performance__text--error"},[e._v("(未達標)")])]),a("div",{staticClass:"branchList__item__info__performance__value"},[a("p",{staticClass:"branchList__item__info__performance__value__current"},[e._v(" "+e._s(e.filterTargetValue(t,"results","value")+e.filterTargetValue(t,"results","unit"))+" ")]),a("p",{staticClass:"branchList__item__info__performance__value__divider"},[e._v(" / ")]),a("p",{staticClass:"branchList__item__info__performance__value__target"},[e._v(" "+e._s(e.filterTargetValue(t,"kpi","value")+e.filterTargetValue(t,"kpi","unit"))+" ")])])])]),a("div",{staticClass:"branchList__item__progress"},[a("ProgressBar",{attrs:{targetValue:100,currentValue:Number(e.filterTargetValue(t,"results","value")),lackValue:Number(e.filterTargetValue(t,"kpi","value")),unit:e.filterTargetValue(t,"kpi","unit")}})],1),a("div",{staticClass:"branchList__item__detailBtn"},[a("el-dropdown",{staticClass:"avatar-container",attrs:{trigger:"click"}},[a("div",{staticClass:"avatar-wrapper"},[a("i",{staticClass:"el-icon-more"})]),a("el-dropdown-menu",{staticClass:"editBranchDetailBtnArea",attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{nativeOn:{click:function(a){return e.opendEditBranchDialog(t.id)}}},[a("i",{staticClass:"el-icon-edit"}),a("span",{staticClass:"editBranchDetailBtn"},[e._v("修改")])])],1)],1)],1)])})),0),a("AddBranchDialog",{ref:"AddBranchDialog",on:{onCreateStore:e.handleCreateStore}}),a("EditBranchDialog",{ref:"EditBranchDialog",on:{onUpdataStore:e.handleUpdataStore}}),a("BranchDetailDialog",{ref:"BranchDetailDialog",attrs:{registed:"branchManagement",branchDetails:e.branchDetail},on:{onPageClick:e.handlePage}})],1)},n=[],s=(a("4de4"),a("b0c0"),a("a9e3"),a("96cf"),a("1da1")),l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"progressBar"},[a("div",{staticClass:"progressBar__bar"},[a("div",{staticClass:"progressBar__bar--lack",style:{width:e.getPercent(e.lackValue,e.targetValue)+"%"}}),a("div",{staticClass:"progressBar__bar--current",style:{width:e.getPercent(e.currentValue,e.targetValue)+"%"}})]),a("div",{staticClass:"progressBar__text"},[e.getPercent(e.currentValue,e.targetValue)>=100?[a("p",{staticClass:"progressBar__text--success"},[e._v("已達標")])]:[100-e.getPercent(e.lackValue,e.targetValue)<=50?[a("p",{staticClass:"progressBar__text--lack--left",style:{right:100-e.getPercent(e.lackValue,e.targetValue)+"%"}},[e._v(" "+e._s(e.lackText+e.lackValue+e.unit)+" "+e._s("("+e.getPercent(e.lackValue,e.targetValue)+"%)")+" ")])]:[a("p",{staticClass:"progressBar__text--lack--right",style:{left:e.getPercent(e.lackValue,e.targetValue)+"%"}},[e._v(" "+e._s(e.lackText+e.lackValue+e.unit)+" "+e._s("("+e.getPercent(e.lackValue,e.targetValue,!0)+"%)")+" ")])]],100-e.getPercent(e.currentValue,e.targetValue)<=63?[a("p",{staticClass:"progressBar__text--current--left",style:{right:100-e.getPercent(e.currentValue,e.targetValue)+"%"}},[e._v(" "+e._s(e.currentText+e.currentValue+e.unit)+" "+e._s("("+e.getPercent(e.currentValue,e.targetValue,!0)+"%)")+" ")])]:[a("p",{staticClass:"progressBar__text--current--right",style:{left:e.getPercent(e.currentValue,e.targetValue)+"%"}},[e._v(" "+e._s(e.currentText+e.currentValue+e.unit)+" "+e._s("("+e.getPercent(e.currentValue,e.targetValue)+"%)")+" ")])]],2)])},c=[],o={name:"ProgressBar",props:{targetText:{type:String,default:"當月目標"},currentText:{type:String,default:"當前業績"},lackText:{type:String,default:"應該達成業績"},targetValue:{type:Number,default:100},currentValue:{type:Number,default:96},lackValue:{type:Number,default:97},unit:{type:String,default:"萬"}},methods:{getPercent:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e=parseFloat(e),t=parseFloat(t),isNaN(e)||isNaN(t))return"-";var r=t<=0?0:Math.round(e/t*1e4)/100;return a?r:r>=100?100:r}}},i=o,u=(a("4483"),a("2877")),m=Object(u["a"])(i,l,c,!1,null,"003ae952",null),d=m.exports,g=a("b08f"),f=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{staticClass:"dialog branchDialog addBranchDialog",attrs:{top:"10vh",title:"開新分店",center:"","close-on-click-modal":!1,"show-close":!1,"close-on-press-escape":!1,"before-close":e.close,"lock-scroll":!0,visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-form",{ref:"addBranchForm",attrs:{rules:e.rules,model:e.form,"label-width":"100px","label-position":"left"}},[a("el-form-item",{attrs:{label:"分店名稱",prop:"name"}},[a("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("el-form-item",{attrs:{label:"地區",prop:"area"}},[a("el-select",{attrs:{placeholder:"請選擇分店地區"},model:{value:e.form.area,callback:function(t){e.$set(e.form,"area",t)},expression:"form.area"}},e._l(e.regionList,(function(e){return a("el-option",{key:e.key,attrs:{label:e.label,value:e.label}})})),1)],1),a("el-form-item",{attrs:{label:"詳細地址",prop:"address"}},[a("el-input",{model:{value:e.form.address,callback:function(t){e.$set(e.form,"address",t)},expression:"form.address"}})],1),a("el-form-item",{attrs:{label:"開幕時間",prop:"openDate"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"選擇日期"},model:{value:e.form.openDate,callback:function(t){e.$set(e.form,"openDate",t)},expression:"form.openDate"}})],1),a("el-form-item",{staticClass:"currentMonthPerformance",attrs:{label:"業績目標",prop:"currentMonthPerformance"}},[a("el-input",{attrs:{type:"number"},model:{value:e.form.currentMonthPerformance,callback:function(t){e.$set(e.form,"currentMonthPerformance",e._n(t))},expression:"form.currentMonthPerformance"}}),a("p",[e._v("萬")])],1),a("el-form-item",{staticClass:"currentMonthOrder",attrs:{label:"訂單目標",prop:"currentMonthOrder"}},[a("el-input",{attrs:{type:"number"},model:{value:e.form.currentMonthOrder,callback:function(t){e.$set(e.form,"currentMonthOrder",e._n(t))},expression:"form.currentMonthOrder"}}),a("p",[e._v("筆")])],1),a("el-form-item",{attrs:{label:"指派店長",prop:"managerName"}},[a("div",{staticClass:"addBranchDialog__managerArea"},[a("p",[e._v(e._s(e.form.manager.name))]),a("el-button",{staticClass:"selectBranchMangerBtn",nativeOn:{click:function(t){return e.opendSelectBranchNameDialog(t)}}},[e._v("選擇店長")])],1)])],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"danger"},on:{click:function(t){return e.close()}}},[e._v("取 消")]),a("el-button",{staticClass:"confirmbtn",attrs:{type:"success"},on:{click:function(t){return e.send()}}},[e._v("確 定")])],1),a("SelectBranchManagerDialog",{ref:"selectBranchManagerDialog",on:{onSelectBranchManager:e.selectBranchManager}})],1)},h=[],p=a("c968"),b=a("73f5"),_=a("b00c"),v=a("ac8a"),k=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{staticClass:"dialog selectBranchManagerDialog",attrs:{top:"10vh",title:"指派店長",center:"",modal:!1,"close-on-press-escape":!1,"close-on-click-modal":!1,"show-close":!1,"before-close":e.close,"lock-scroll":!0,visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("div",[a("div",{staticClass:"selectBranchArea"},[a("p",{staticClass:"selectBranchManagerDialog__title"},[e._v("選擇分店")]),a("el-select",{staticClass:"selectBranchName",attrs:{placeholder:"請選擇分店",clearable:""},on:{change:e.getEmployeeList},model:{value:e.selectBranchName,callback:function(t){e.selectBranchName=t},expression:"selectBranchName"}},e._l(e.branchList,(function(e){return a("el-option",{key:e.key,attrs:{label:e.label,value:e.value}})})),1)],1),a("div",{staticClass:"selectManagerNameArea"},[a("p",{staticClass:"selectBranchManagerDialog__title"},[e._v("搜尋姓名")]),a("el-input",{staticClass:"selectBranchManagerName",on:{change:e.getEmployeeList},model:{value:e.selectBranchManagerName,callback:function(t){e.selectBranchManagerName=t},expression:"selectBranchManagerName"}})],1),a("p",{staticClass:"branchManagerTableTitle"},[e._v("搜尋清單")]),a("el-table",{ref:"branchManagerTable",staticStyle:{width:"100%"},attrs:{data:e.branchManagerTableData,height:"250",border:"","highlight-current-row":""},on:{"current-change":e.handleCurrentChange}},[a("template",{slot:"empty"},[a("p",[e._v("目前無資料")])]),a("el-table-column",{attrs:{prop:"branch",label:"分店",width:"180"}}),a("el-table-column",{attrs:{prop:"title",label:"頭銜",width:"180"}}),a("el-table-column",{attrs:{prop:"name",label:"姓名"}})],2)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"danger"},on:{click:function(t){return e.close()}}},[e._v("取 消")]),a("el-button",{attrs:{type:"success"},on:{click:function(t){return e.certain()}}},[e._v("確 定")])],1)])},M=[],B=(a("d81d"),a("ef75")),D={data:function(){return{dialogVisible:!1,selectBranchName:"",selectBranchManagerName:"",branchList:[{key:1,label:"西門店",value:"1"}],branchManagerTableData:[{id:1,branch:"西門店",title:"店長",name:"黃小明"},{id:2,branch:"西門店",title:"教練",name:"黃中明"},{id:3,branch:"西門店",title:"教練",name:"黃大明"},{id:4,branch:"西門店",title:"教練",name:"林小明"},{id:5,branch:"西門店",title:"教練",name:"林中明"},{id:6,branch:"西門店",title:"教練",name:"林大明"}],currentRow:null}},computed:{},methods:{opend:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=e,t.next=3,a.getStoreList();case 3:return t.next=5,a.getEmployeeList();case 5:a.dialogVisible=!0;case 6:case"end":return t.stop()}}),t)})))()},getStoreList:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a,r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=e,t.prev=1,r={key:null,f:"droplist"},t.next=5,Object(b["e"])(r);case 5:if(n=t.sent,n.status===_["a"].success){t.next=9;break}return a.sentMessage("取得分店清單","error"),t.abrupt("return",!1);case 9:return a.branchList=n.data.map((function(e,t){var a={key:t+1,label:e.name,value:e.id};return a})),t.abrupt("return",!0);case 13:return t.prev=13,t.t0=t["catch"](1),a.sentMessage("取得分店清單錯誤","error"),console.log("取得分店清單",t.t0),t.abrupt("return",!1);case 18:case"end":return t.stop()}}),t,null,[[1,13]])})))()},getEmployeeList:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a,r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=e,t.prev=1,r={key:""===a.selectBranchManagerName?null:a.selectBranchManagerName,s:""===a.selectBranchName?null:a.selectBranchName,page:1,limit:1e4},t.next=5,Object(B["d"])(r);case 5:if(n=t.sent,n.status===_["a"].success){t.next=9;break}return a.sentMessage("取得員工清單","error"),t.abrupt("return",!1);case 9:return a.branchManagerTableData=n.data.rows.map((function(e,t){var a={id:e.id,branch:e.store.name,title:e.store.title,name:e.name};return a})),t.abrupt("return",!0);case 13:return t.prev=13,t.t0=t["catch"](1),a.branchManagerTableData=[],a.sentMessage("取得清單錯誤","error"),console.log("取得員工清單",t.t0),t.abrupt("return",!1);case 19:case"end":return t.stop()}}),t,null,[[1,13]])})))()},sentMessage:function(e,t){var a="success"===t?"成功":"錯誤";this.$notify({type:t,title:a,message:e})},close:function(){this.selectBranchName="",this.selectBranchManagerName="",this.currentRow=null,this.dialogVisible=!1},handleCurrentChange:function(e){this.currentRow=e},setCurrent:function(e){this.$refs.branchManagerTable.setCurrentRow(e)},certain:function(){var e=this;null==e.currentRow?e.$notify.error({title:"錯誤",message:"請選擇一位人員"}):(e.$emit("onSelectBranchManager",e.currentRow),e.close())}},created:function(){}},y=D,C=Object(u["a"])(y,k,M,!1,null,"65d79f3c",null),x=C.exports,w={components:{SelectBranchManagerDialog:x},data:function(){return{dialogVisible:!1,form:{name:"",area:"",openDate:"",address:"",currentMonthPerformance:"",currentMonthOrder:"",managerName:"",manager:{name:"",id:""}},rules:{name:[{required:!0,message:"請輸入店名",trigger:"change"},{min:1,message:"長度至少 1 個字文以上",trigger:"change"}],area:[{required:!0,message:"請選擇區域",trigger:"change"}],openDate:[{type:"date",required:!0,message:"請選擇開幕日期",trigger:"change"}],address:[{required:!0,message:"請輸入詳細地址",trigger:"change"}],currentMonthPerformance:[{required:!0,message:"業績目標不能為空"},{min:0,type:"number",message:"業績目標必須為數值和大於 0"}],currentMonthOrder:[{required:!0,message:"訂單目標不能為空"},{min:0,type:"number",message:"訂單目標必須為數值和大於 0"}],managerName:[{required:!0,message:"請選擇店長",trigger:"change"}]},regionList:v["a"]}},computed:{},methods:{opend:function(){this.dialogVisible=!0},close:function(){this.formatForm(),this.resetForm(),this.dialogVisible=!1},formatForm:function(){this.form={name:"",area:"",openDate:"",address:"",currentMonthPerformance:"",currentMonthOrder:"",managerName:"",manager:{name:"",id:""}}},send:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a,r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a=e,t.prev=1,r=a.checkFormData(),!r){t.next=7;break}return n={name:a.form.name,area:a.form.area,address:a.form.address,openDate:Object(p["c"])(a.form.openDate),kpi:[{name:"業績目標",value:a.form.currentMonthPerformance,unit:"萬"},{name:"訂單數量",value:a.form.currentMonthOrder,unit:"筆"}],managerId:a.form.manager.id},t.next=7,a.createStore(n);case 7:t.next=14;break;case 9:t.prev=9,t.t0=t["catch"](1),console.log("新增分店錯誤",t.t0),a.sentMessage("新增分店錯誤","error"),a.close();case 14:case"end":return t.stop()}}),t,null,[[1,9]])})))()},createStore:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var r,n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return r=t,a.prev=1,a.next=4,Object(b["a"])(e);case 4:n=a.sent,n.status===_["a"].success?(r.sentMessage("新增分店成功","success"),r.close(),r.emitCreateStore()):r.sentMessage("新增分店錯誤","error"),a.next=12;break;case 8:a.prev=8,a.t0=a["catch"](1),r.sentMessage("新增分店錯誤","error"),console.log("新增分店錯誤",a.t0);case 12:case"end":return a.stop()}}),a,null,[[1,8]])})))()},sentMessage:function(e,t){var a="success"===t?"成功":"錯誤";this.$notify({type:t,title:a,message:e})},resetForm:function(){this.$refs["addBranchForm"].resetFields()},checkFormData:function(){var e=null;return this.$refs["addBranchForm"].validate((function(t){return t?(e=!0,!0):(e=!1,!1)})),e},emitCreateStore:function(){this.$store.dispatch("app/toggleLoading",!0),this.$emit("onCreateStore")},opendSelectBranchNameDialog:function(){var e=this;e.$refs.selectBranchManagerDialog.opend()},selectBranchManager:function(e){this.form.managerName=e.name,this.form.manager={name:e.name,id:e.id}}},created:function(){}},V=w,$=Object(u["a"])(V,f,h,!1,null,"40207da4",null),N=$.exports,O=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{staticClass:"dialog branchDialog editBranchDialog",attrs:{top:"10vh",title:"修改分店資料",center:"","close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1,"before-close":e.close,"lock-scroll":!0,visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-form",{ref:"editBranchform",attrs:{model:e.form,rules:e.rules,"label-width":"100px","label-position":"left"}},[a("el-form-item",{attrs:{label:"分店名稱",prop:"name"}},[a("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("el-form-item",{attrs:{label:"地區",prop:"area"}},[a("el-select",{attrs:{placeholder:"請選擇分店地區"},model:{value:e.form.area,callback:function(t){e.$set(e.form,"area",t)},expression:"form.area"}},e._l(e.regionList,(function(e){return a("el-option",{key:e.key,attrs:{label:e.label,value:e.label}})})),1)],1),a("el-form-item",{attrs:{label:"詳細地址",prop:"address"}},[a("el-input",{model:{value:e.form.address,callback:function(t){e.$set(e.form,"address",t)},expression:"form.address"}})],1),a("el-form-item",{attrs:{label:"成立時間",prop:"openDate"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"選擇日期"},model:{value:e.form.openDate,callback:function(t){e.$set(e.form,"openDate",t)},expression:"form.openDate"}})],1),a("el-form-item",{staticClass:"currentMonthPerformance",attrs:{label:"業績目標",prop:"currentMonthPerformance"}},[a("el-input",{attrs:{type:"number"},model:{value:e.form.currentMonthPerformance,callback:function(t){e.$set(e.form,"currentMonthPerformance",e._n(t))},expression:"form.currentMonthPerformance"}}),a("p",[e._v("萬")])],1),a("el-form-item",{staticClass:"currentMonthOrder",attrs:{label:"訂單目標",prop:"currentMonthOrder"}},[a("el-input",{attrs:{type:"number"},model:{value:e.form.currentMonthOrder,callback:function(t){e.$set(e.form,"currentMonthOrder",e._n(t))},expression:"form.currentMonthOrder"}}),a("p",[e._v("筆")])],1),a("el-form-item",{attrs:{label:"指派店長",prop:"managerName"}},[a("div",{staticClass:"addBranchDialog__managerArea"},[a("p",[e._v(e._s(e.form.manager.name))]),a("el-button",{staticClass:"selectBranchMangerBtn",nativeOn:{click:function(t){return e.opendSelectBranchNameDialog(t)}}},[e._v("選擇店長")])],1)])],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"danger"},on:{click:function(t){return e.close()}}},[e._v("取 消")]),a("el-button",{staticClass:"confirmbtn",attrs:{type:"success"},on:{click:function(t){return e.send()}}},[e._v("確 定")])],1),a("SelectBranchManagerDialog",{ref:"selectBranchManagerDialog",on:{onSelectBranchManager:e.selectBranchManager}})],1)},L=[],P={components:{SelectBranchManagerDialog:x},data:function(){return{dialogVisible:!1,form:{id:"",name:"",area:"",openDate:"",address:"",currentMonthPerformance:0,currentMonthOrder:0,managerName:"",manager:{name:"",id:""}},rules:{name:[{required:!0,message:"請輸入店名",trigger:"change"},{min:1,message:"長度至少 1 個字文以上",trigger:"change"}],area:[{required:!0,message:"請選擇區域",trigger:"change"}],openDate:[{type:"date",required:!0,message:"請選擇開幕日期",trigger:"change"}],address:[{required:!0,message:"請輸入詳細地址",trigger:"change"}],currentMonthPerformance:[{required:!0,message:"業績目標不能為空"},{min:0,type:"number",message:"業績目標必須為數值和大於 0"}],currentMonthOrder:[{required:!0,message:"訂單目標不能為空"},{min:0,type:"number",message:"訂單目標必須為數值和大於 0"}],managerName:[{required:!0,message:"請選擇店長",trigger:"change"}]},regionList:v["a"]}},computed:{},methods:{opend:function(){this.dialogVisible=!0},close:function(){this.formatForm(),this.resetForm(),this.dialogVisible=!1},formatForm:function(){this.form={id:"",name:"",area:"",openDate:"",address:"",currentMonthPerformance:"",currentMonthOrder:"",managerName:"",manager:{name:"",id:""}}},resetForm:function(){this.$refs["editBranchform"].resetFields()},checkFormData:function(){var e=null;return this.$refs["editBranchform"].validate((function(t){return t?(e=!0,!0):(e=!1,!1)})),e},opendSelectBranchNameDialog:function(){var e=this;e.$refs.selectBranchManagerDialog.opend()},selectBranchManager:function(e){this.form.managerName=e.name,this.form.manager={name:e.name,id:e.id}},send:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a,r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a=e,t.prev=1,r=a.checkFormData(),!r){t.next=7;break}return n={name:a.form.name,area:a.form.area,address:a.form.address,openDate:Object(p["c"])(a.form.openDate),kpi:[{name:"業績目標",value:a.form.currentMonthPerformance,unit:"萬"},{name:"訂單數量",value:a.form.currentMonthOrder,unit:"筆"}],managerId:a.form.manager.id},t.next=7,a.editStore(n,a.form.id);case 7:t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](1),console.log("修改分店錯誤",t.t0);case 12:case"end":return t.stop()}}),t,null,[[1,9]])})))()},editStore:function(e,t){var a=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){var n,s;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return n=a,r.prev=1,r.next=4,Object(b["f"])(e,t);case 4:s=r.sent,s.status===_["a"].success?(n.sentMessage("修改分店成功","success"),n.close(),n.emitUpdataStore()):n.sentMessage("修改分店錯誤","error"),r.next=13;break;case 8:r.prev=8,r.t0=r["catch"](1),n.sentMessage("修改分店錯誤","error"),n.close(),console.log("修改分店錯誤",r.t0);case 13:case"end":return r.stop()}}),r,null,[[1,8]])})))()},sentMessage:function(e,t){var a="success"===t?"成功":"錯誤";this.$notify({type:t,title:a,message:e})},emitUpdataStore:function(){this.$store.dispatch("app/toggleLoading",!0),this.$emit("onUpdataStore")}},created:function(){}},S=P,R=Object(u["a"])(S,O,L,!1,null,"59b28a76",null),T=R.exports,j={name:"BranchManagement",components:{ProgressBar:d,BranchDetailDialog:g["a"],AddBranchDialog:N,EditBranchDialog:T},data:function(){return{}},methods:{sentMessage:function(e,t){var a="success"===t?"成功":"錯誤";this.$notify({type:t,title:a,message:e})},opendAddBranchDialog:function(){var e=this;e.$refs.AddBranchDialog.opend()},opendEditBranchDialog:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var r,n,s,l,c,o,i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return r=t,a.prev=1,a.next=4,r.getStoreDetails(e);case 4:n=a.sent,n&&(i=t.$store.state.navbarInfo.branchManagement.detail,r.$refs.EditBranchDialog.form={id:e,name:i.name,area:i.area,openDate:new Date(i.openDate),address:i.address,currentMonthPerformance:null!==(s=Number(null===(l=i.kpi.filter((function(e){return"業績目標"===e.name}))[0])||void 0===l?void 0:l.value))&&void 0!==s?s:0,currentMonthOrder:null!==(c=Number(null===(o=i.kpi.filter((function(e){return"訂單數量"===e.name}))[0])||void 0===o?void 0:o.value))&&void 0!==c?c:0,managerName:i.manager.name,manager:{name:i.manager.name,id:i.manager.id}},r.$refs.EditBranchDialog.opend()),a.next=11;break;case 8:a.prev=8,a.t0=a["catch"](1),console.log(a.t0);case 11:case"end":return a.stop()}}),a,null,[[1,8]])})))()},opendBranchDetailDialog:function(e,t){var a=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){var n,s;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return n=a,r.prev=1,r.next=4,n.getStoreDetails(e);case 4:s=r.sent,s&&(n.$store.dispatch("navbarInfo/setBranchManagmentIndex",t),n.$refs.BranchDetailDialog.opend()),r.next=11;break;case 8:r.prev=8,r.t0=r["catch"](1),console.log(r.t0);case 11:case"end":return r.stop()}}),r,null,[[1,8]])})))()},getStoreDetails:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var r,n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return r=t,a.prev=1,a.next=4,Object(b["d"])(e);case 4:if(n=a.sent,n.status!==_["a"].success){a.next=8;break}return r.$store.dispatch("navbarInfo/setBranchManagmentDetail",n.data),a.abrupt("return",!0);case 8:return r.sentMessage("取得分店資訊錯誤","error"),a.abrupt("return",!1);case 12:return a.prev=12,a.t0=a["catch"](1),console.log("取得分店資訊錯誤",a.t0),r.sentMessage("取得分店資訊錯誤","error"),a.abrupt("return",!1);case 17:return a.prev=17,t.$store.dispatch("app/toggleLoading",!1),a.finish(17);case 20:case"end":return a.stop()}}),a,null,[[1,12,17,20]])})))()},handlePage:function(e){var t=this,a=t.$store.state.navbarInfo.branchManagement.index;switch(t.$store.dispatch("app/toggleLoading",!0),e){case"pre":a-=1;break;case"next":a+=1;break;default:break}var r=t.$store.state.navbarInfo.branchManagement.list[a].id;t.$refs.BranchDetailDialog.close(),t.opendBranchDetailDialog(r,a)},handleCreateStore:function(){this.$router.go()},handleUpdataStore:function(){this.$router.go()},filterTargetValue:function(e,t,a){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"業績目標",n=e[t].filter((function(e){return e.name===r}));if(0===n.length)switch(a){case"name":return"業績目標";case"value":return 0;case"unit":return"萬"}return n[0][a]}},computed:{storeList:function(){return this.$store.state.navbarInfo.branchManagement.list},branchDetail:function(){return this.$store.state.navbarInfo.branchManagement.detail}}},F=j,E=(a("8d44"),Object(u["a"])(F,r,n,!1,null,"d09ed240",null));t["default"]=E.exports},4483:function(e,t,a){"use strict";var r=a("858f"),n=a.n(r);n.a},"858f":function(e,t,a){},8917:function(e,t,a){},"8d44":function(e,t,a){"use strict";var r=a("8917"),n=a.n(r);n.a},ac8a:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var r=[{key:1,label:"基隆市",value:"1"},{key:2,label:"臺北市",value:"2"},{key:3,label:"新北市",value:"3"},{key:4,label:"桃園市",value:"4"},{key:5,label:"新竹市",value:"5"},{key:6,label:"新竹縣",value:"6"},{key:7,label:"苗栗縣",value:"7"},{key:8,label:"臺中市",value:"8"},{key:9,label:"彰化縣",value:"9"},{key:10,label:"南投縣",value:"10"},{key:11,label:"雲林縣",value:"11"},{key:12,label:"嘉義市",value:"12"},{key:13,label:"嘉義縣",value:"13"},{key:14,label:"台南市",value:"14"},{key:15,label:"高雄市",value:"15"},{key:16,label:"屏東縣",value:"16"},{key:17,label:"台東縣",value:"17"},{key:18,label:"花蓮縣",value:"18"},{key:19,label:"宜蘭縣",value:"19"},{key:20,label:"澎湖縣",value:"20"},{key:21,label:"金門縣",value:"21"},{key:22,label:"連江縣",value:"22"}]}}]);